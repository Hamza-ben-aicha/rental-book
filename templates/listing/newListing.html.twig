{% extends 'base.html.twig' %}

{% block title %}{% endblock %}

{% block body %}
    <h2>Post new listing:</h2>

    {{ form_start(form) }}
        {{ form_label(form.listingCategory) }}
        {{ form_widget(form.listingCategory) }}

        {{ form_label(form.name) }}
        {{ form_widget(form.name) }}

        {{ form_label(form.description) }}
        {{ form_widget(form.description) }}

        {{ form_label(form.price) }}
        {{ form_widget(form.price) }}

        {{ form_label(form.beds) }}
        {{ form_widget(form.beds) }}

        {{ form_label(form.guests) }}
        {{ form_widget(form.guests) }}

        {{ form_label(form.latitude) }}
        {{ form_widget(form.latitude) }}

        {{ form_label(form.longitude) }}
        {{ form_widget(form.longitude) }}
                
        <br>
        <label for="listingAmenities">Amenities</label>
        <ul class="listingAmenities" 
            data-index="{{ form.listingAmenities|length > 0 ? form.listingAmenities|last.vars.name + 1 : 0 }}" 
            data-prototype="{{ form_widget(form.listingAmenities.vars.prototype)|e('html_attr') }}"
            style="list-style-type:none;"
        >
        </ul>
        <br>

        <label for="listingAvailabilities">Availabilities</label>
        <ul class="listingAvailabilities" 
            data-index="{{ form.listingAvailabilities|length > 0 ? form.listingAvailabilities|last.vars.name + 1 : 0 }}" 
            data-prototype="{{ form_widget(form.listingAvailabilities.vars.prototype)|e('html_attr') }}"
            style="list-style-type:none;"
        >
        </ul>
        <br>
        
        {{ form_widget(form.enregistrer) }}
    {{ form_end(form) }} 
    <script>
        const addTagLink = document.createElement('button')
        addTagLink.classList.add('add_tag_list')
        addTagLink.innerText = 'Add new amenity'
        addTagLink.dataset.collectionHolderClass = 'listingAmenities'

        const newLinkLi = document.createElement('li').append(addTagLink)

        const collectionHolder = document.querySelector('ul.listingAmenities')
        collectionHolder.appendChild(addTagLink)

        const addFormToCollection = (e) => {
            e.preventDefault();
            const collectionHolder = document.querySelector('.' + e.currentTarget.dataset.collectionHolderClass);

            const item = document.createElement('li');

            item.innerHTML = collectionHolder
                .dataset
                .prototype
                .replace(
                /__name__/g,
                collectionHolder.dataset.index
                );

            collectionHolder.appendChild(item);

            collectionHolder.dataset.index++;
        }

        addTagLink.addEventListener("click", addFormToCollection)
    </script>
    <script>
        const addTagLinkOne = document.createElement('button')
        addTagLinkOne.classList.add('add_tag_list_1')
        addTagLinkOne.innerText = 'Add new availability'
        addTagLinkOne.dataset.collectionHolderClass = 'listingAvailabilities'

        const newLinkLiOne = document.createElement('li').append(addTagLinkOne)

        const collectionHolderOne = document.querySelector('ul.listingAvailabilities')
        collectionHolderOne.appendChild(addTagLinkOne)

        const addFormToCollectionOne = (e) => {
            e.preventDefault();
            const collectionHolderOne = document.querySelector('.' + e.currentTarget.dataset.collectionHolderClass);

            const item = document.createElement('li');

            item.innerHTML = collectionHolderOne
                .dataset
                .prototype
                .replace(
                /__name__/g,
                collectionHolderOne.dataset.index
                );

            collectionHolderOne.appendChild(item);

            collectionHolderOne.dataset.index++;
        }

        addTagLinkOne.addEventListener("click", addFormToCollectionOne)
    </script>
    <style>
        .add_tag_list {
            box-sizing: border-box;
            -webkit-appearance: none;
                -moz-appearance: none;
                    appearance: none;
            background-color: transparent;
            border: 2px solid #e74c3c;
            border-radius: 0.6em;
            color: #e74c3c;
            cursor: pointer;
            display: flex;
            align-self: center;
            font-size: 1rem;
            font-weight: 400;
            line-height: 1;
            margin: 20px;
            padding: 1.2em 2.8em;
            text-decoration: none;
            text-align: center;
            text-transform: uppercase;
            font-family: "Montserrat", sans-serif;
            font-weight: 700;
        }
        .add_tag_list_1 {
            box-sizing: border-box;
            -webkit-appearance: none;
                -moz-appearance: none;
                    appearance: none;
            background-color: transparent;
            border: 2px solid #ef8b80;
            border-radius: 0.6em;
            color: #ef8b80;
            cursor: pointer;
            display: flex;
            align-self: center;
            font-size: 1rem;
            font-weight: 400;
            line-height: 1;
            margin: 20px;
            padding: 1.2em 2.8em;
            text-decoration: none;
            text-align: center;
            text-transform: uppercase;
            font-family: "Montserrat", sans-serif;
            font-weight: 700;
        }

        .add_tag_list:hover, .add_tag_list:focus {
            color: #fff;
            background-image: linear-gradient(45deg, #f1c40f 50%, transparent 88%);
            outline: 0;
        }
        .add_tag_list_1:hover, .add_tag_list_1:focus {
            color: #fff;
            background-image: linear-gradient(45deg, #efc380 50%, transparent 88%);
            outline: 0;
        }
    </style>
{% endblock %}

